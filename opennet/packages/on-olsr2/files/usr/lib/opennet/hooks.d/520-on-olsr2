#!/bin/sh

set -eu


case "$1" in
	network|wireless|firewall)
		. "${IPKG_INSTROOT:-}/usr/lib/opennet/on-helper.sh"
		# Zonen- und IP-Aenderungen koennen Policy-Routing-Aenderungen erfordern
		init_policy_routing_ipv6
		# eventuelle Zonen-Zuordnungen zu olsrd2 uebertragen
		update_olsr2_interfaces
		;;
	olsrd2)
		. "${IPKG_INSTROOT:-}/usr/lib/opennet/on-helper.sh"
		if is_on_module_installed_and_enabled "on-olsr2"; then
			/etc/init.d/olsrd2 reload >/dev/null || true
		fi
		;;
	on-olsr2)
		. "${IPKG_INSTROOT:-}/usr/lib/opennet/on-helper.sh"
		init_policy_routing_ipv6
		update_olsr2_interfaces
		update_olsr2_daemon_state
		;;
esac
