#!/bin/sh /etc/rc.common
#
# Opennet Firmware
# 
# Copyright 2010 Rene Ejury <opennet@absorb.it>
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#	http://www.apache.org/licenses/LICENSE-2.0
# 

# wir verwenden procd fuer die Ueberwachung der firewall-Zone
USE_PROCD=1

START=30

service_triggers() {
	# firewall: relevant fuer die Interface-Liste von olsrd
	# network: relevant fuer das policy-Routing von olsrd
	# Bei Aenderungen wird die Aktion "reload", bzw. "stop" und "start" ausgeloest.
	procd_add_reload_trigger firewall network
}


start() {
	. "${IPKG_INSTROOT:-}/usr/lib/opennet/on-helper.sh"

	# neue OLSR interfaces?
	update_olsr_interfaces

	# neue lokale Interfaces?
	initialize_olsrd_policy_routing
}

